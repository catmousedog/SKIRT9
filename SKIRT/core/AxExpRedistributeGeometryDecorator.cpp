
/*//////////////////////////////////////////////////////////////////
////     The SKIRT project -- advanced radiative transfer       ////
////       Â© Astronomical Observatory, Ghent University         ////
///////////////////////////////////////////////////////////////// */

#include "AxExpRedistributeGeometryDecorator.hpp"

////////////////////////////////////////////////////////////////////

int AxExpRedistributeGeometryDecorator::dimension() const
{
    return max(2, geometry()->dimension());
}

////////////////////////////////////////////////////////////////////

double AxExpRedistributeGeometryDecorator::weight(Position bfr) const
{
    double R = bfr.cylRadius();
    double z = abs(bfr.z());
    return exp(-R/_LR) * exp(-z/_Lz);
}

////////////////////////////////////////////////////////////////////

double AxExpRedistributeGeometryDecorator::maxWeight() const
{
    return 1;
}

////////////////////////////////////////////////////////////////////
